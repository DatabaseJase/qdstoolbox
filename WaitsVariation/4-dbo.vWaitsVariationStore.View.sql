CREATE OR ALTER VIEW [dbo].[vWaitsVariationStore]
AS
SELECT
	 [wvi].[ReportID]
	,[wvs].[QueryID]
	,[wvs].[ObjectID]
	,[wvs].[SchemaName]
	,[wvs].[ObjectName]
	,[wvs].[ExecutionCount_Recent]		
	,[wvs].[ExecutionCount_History]		
	,[wvs].[ExecutionCount_Variation%]	
	,[wvs].[Total_Recent]					
	,[wvs].[Total_History]				
	,[wvs].[Total_Variation%]				
	,[wvs].[Unknown_Recent]				
	,[wvs].[Unknown_History]				
	,[wvs].[Unknown_Variation%]			
	,[wvs].[CPU_Recent]					
	,[wvs].[CPU_History]					
	,[wvs].[CPU_Variation%]				
	,[wvs].[WorkerThread_Recent]			
	,[wvs].[WorkerThread_History]			
	,[wvs].[WorkerThread_Variation%]		
	,[wvs].[Lock_Recent]					
	,[wvs].[Lock_History]					
	,[wvs].[Lock_Variation%]				
	,[wvs].[Latch_Recent]					
	,[wvs].[Latch_History]				
	,[wvs].[Latch_Variation%]				
	,[wvs].[BufferLatch_Recent]			
	,[wvs].[BufferLatch_History]			
	,[wvs].[BufferLatch_Variation%]		
	,[wvs].[BufferIO_Recent]				
	,[wvs].[BufferIO_History]				
	,[wvs].[BufferIO_Variation%]			
	,[wvs].[Compilation_Recent]			
	,[wvs].[Compilation_History]			
	,[wvs].[Compilation_Variation%]		
	,[wvs].[SQLCLR_Recent]				
	,[wvs].[SQLCLR_History]				
	,[wvs].[SQLCLR_Variation%]			
	,[wvs].[Mirroring_Recent]				
	,[wvs].[Mirroring_History]			
	,[wvs].[Mirroring_Variation%]			
	,[wvs].[Transaction_Recent]			
	,[wvs].[Transaction_History]			
	,[wvs].[Transaction_Variation%]		
	,[wvs].[Idle_Recent]					
	,[wvs].[Idle_History]					
	,[wvs].[Idle_Variation%]				
	,[wvs].[Preemptive_Recent]			
	,[wvs].[Preemptive_History]			
	,[wvs].[Preemptive_Variation%]		
	,[wvs].[ServiceBroker_Recent]			
	,[wvs].[ServiceBroker_History]		
	,[wvs].[ServiceBroker_Variation%]		
	,[wvs].[TranLogIO_Recent]				
	,[wvs].[TranLogIO_History]			
	,[wvs].[TranLogIO_Variation%]			
	,[wvs].[NetworkIO_Recent]				
	,[wvs].[NetworkIO_History]			
	,[wvs].[NetworkIO_Variation%]			
	,[wvs].[Parallelism_Recent]			
	,[wvs].[Parallelism_History]			
	,[wvs].[Parallelism_Variation%]		
	,[wvs].[Memory_Recent]				
	,[wvs].[Memory_History]				
	,[wvs].[Memory_Variation%]			
	,[wvs].[UserWait_Recent]				
	,[wvs].[UserWait_History]				
	,[wvs].[UserWait_Variation%]			
	,[wvs].[Tracing_Recent]				
	,[wvs].[Tracing_History]				
	,[wvs].[Tracing_Variation%]			
	,[wvs].[FullTextSearch_Recent]		
	,[wvs].[FullTextSearch_History]		
	,[wvs].[FullTextSearch_Variation%]	
	,[wvs].[OtherDiskIO_Recent]			
	,[wvs].[OtherDiskIO_History]			
	,[wvs].[OtherDiskIO_Variation%]		
	,[wvs].[Replication_Recent]			
	,[wvs].[Replication_History]			
	,[wvs].[Replication_Variation%]		
	,[wvs].[LogRateGovernor_Recent]		
	,[wvs].[LogRateGovernor_History]		
	,[wvs].[LogRateGovernor_Variation%]	
	,CAST(DECOMPRESS([wvs].[QueryText]) AS NVARCHAR(MAX))	AS [QueryText]
FROM [dbo].[WaitsVariationStore] [wvs]
INNER JOIN [dbo].[vWaitsVariationIndex] [wvi]
ON [wvs].[ReportID] = [wvi].[ReportID]
